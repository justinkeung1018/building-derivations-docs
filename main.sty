% Language and font encodings
\usepackage[UKenglish]{babel}
\usepackage[UKenglish]{datetime}
\let\dateUKenglish\relax
\newdateformat{dateUKenglish}{\THEDAY~\monthname[\THEMONTH] \THEYEAR}
\dateUKenglish

% Fonts
\usepackage[tt=false, type1=true]{libertine}
% \usepackage[varqu]{zi4} % In LuaTeX this turns quotes into \textquotesingle within listings, breaking the tt font
% \usepackage[libertine]{newtxmath}
% \usepackage[scaled=0.8, lining]{FiraMono}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% Sets page size and margins
\usepackage[a4paper,top=2.5cm,bottom=2.5cm,left=2.5cm,right=2.5cm,marginparwidth=1.75cm]{geometry}

% New line between paragraphs
\usepackage{parskip}

% Useful packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=blue, pdfencoding=auto, psdextra]{hyperref}
\usepackage{cleveref}
\usepackage{csquotes}

% Display figures side by side
\usepackage{subcaption}
% https://tex.stackexchange.com/questions/218378/forcing-subfigures-to-have-same-height-and-take-overall-x-of-linewidth-in-latex
\newlength{\twosubht}
\newsavebox{\twosubbox}

% Fancy headers
\usepackage{fancyhdr}
\newcommand{\maintitle}{Building derivations}

% Greek letters (lambda) in bibliography
\usepackage{textgreek}

\let\Chaptermark\chaptermark
\def\chaptermark#1{\def\Chaptername{#1}\Chaptermark{#1}}
\let\Sectionmark\sectionmark
\def\sectionmark#1{\def\Sectionname{#1}\Sectionmark{#1}}
\let\Subsectionmark\subsectionmark
\def\subsectionmark#1{\def\Subsectionname{#1}\Subsectionmark{#1}}
\let\Subsubsectionmark\subsubsectionmark
\def\subsubsectionmark#1{\def\Subsubsectionname{#1}\Subsubsectionmark{#1}}

% The table of contents needs a separate page style because the command \Chaptername is undefined in the table of contents, so we cannot use the fancy page style with a table of contents at least two pages long
\fancypagestyle{toc}{
    \lhead{\maintitle}
    \rhead{Table of contents}
    \lfoot{Justin Keung}
    \renewcommand{\footrulewidth}{0.4pt} % Make footer line visible
    \setlength{\headheight}{13.59999pt}
}

\fancypagestyle{fancy}{
    \lhead{\maintitle}
    \rhead{\textsc{\Chaptername}}
    \lfoot{Justin Keung}
    \renewcommand{\footrulewidth}{0.4pt} % Make footer line visible
    \setlength{\headheight}{13.59999pt}
}

% Biblatex
\usepackage[backend=biber,style=numeric,urldate=long,uniquename=false]{biblatex}
\addbibresource{bibliography.bib}

% Colours
\definecolor[named]{ImperialBlue}{HTML}{003e74}
\definecolor[named]{ForestGreen}{HTML}{009B55}
\definecolor[named]{Mint}{HTML}{96DEC4}
\definecolor[named]{DarkRed}{HTML}{A50000}
\definecolor[named]{ACMPurple}{cmyk}{0.55,1,0,0.15}
\definecolor[named]{ACMDarkBlue}{cmyk}{1,0.58,0,0.21}
\hypersetup{colorlinks,
    linkcolor=ACMPurple,
    citecolor=ACMPurple,
    urlcolor=ACMDarkBlue,
    filecolor=ACMDarkBlue}

% EBNF syntax
\newcommand{\nonterm}[1]{\langle\mathit{#1}\rangle}
\newcommand{\term}[1]{\text{ `#1' }}
\newcommand{\alt}{\ |\ }

% Proof system abbreviations
\newcommand{\ndt}{$\textsc{nd}_\to$}
\newcommand{\lbm}{$\bar{\lambda}{\mu}{\tilde{\mu}}$}

% Arrows for inference rule names (no spacing after the arrow)
\newcommand{\arr}{\mathord{\to}}

% More spacing
\newcommand{\tquad}{\quad\quad\quad}

% Handle Dutch surnames with "van", see https://tex.stackexchange.com/questions/40747/bibtex-handling-of-the-dutch-van-name-prefix-with-natbib/40750#40750
\DeclareRobustCommand{\VAN}[3]{#2}

% Code
\usepackage{listings}
% \usepackage{color}
% \definecolor{lightgray}{rgb}{.9,.9,.9}
% \definecolor{darkgray}{rgb}{.4,.4,.4}
% \definecolor{purple}{rgb}{0.65, 0.12, 0.82}
% \lstdefinelanguage{JavaScript}{
%   keywords={break, case, catch, continue, debugger, default, delete, do, else, false, finally, for, function, if, in, instanceof, new, null, return, switch, this, throw, true, try, typeof, var, void, while, with},
%   morecomment=[l]{//},
%   morecomment=[s]{/*}{*/},
%   morestring=[b]',
%   morestring=[b]",
%   ndkeywords={class, export, boolean, throw, implements, import, this},
%   keywordstyle=\color{blue}\bfseries,
%   ndkeywordstyle=\color{darkgray}\bfseries,
%   identifierstyle=\color{black},
%   commentstyle=\color{purple}\ttfamily,
%   stringstyle=\color{red}\ttfamily,
%   sensitive=true
% }

\lstset{
%   language=JavaScript,
  basicstyle=\ttfamily,
  mathescape,
  breaklines,
  alsoletter={_},
  gobble=4,
  columns=fullflexible,
  % framesep=1pt,
  numbers=left,
  numberstyle=\ttfamily\footnotesize,
  xleftmargin=20pt,
  xrightmargin=5pt,
  % showspaces,
  keepspaces,
  escapechar=@,
  % belowskip=-0.8 \baselineskip,
}

% Tables
\usepackage{tabularray}
\usepackage{booktabs}
\UseTblrLibrary{booktabs}

% Name of the web app
\newcommand{\projectname}{Embla}

% Definitions and remarks
\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{remark}{Remark}[chapter]